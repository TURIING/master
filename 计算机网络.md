### 第1章 计算机网络体系结构

#### 计算机网络的功能

* 数据通信

    __计算机网络中最基本最重要的功能__

* 资源共享

    可以是软件、数据、硬件共享

* 分布式处理

* 提高可靠性

* 负载均衡

#### 计算机网络的组成

* 从组成部分上看

    __一个完整的计算机网络主要由硬件、软件、协议三部分组成__

* 从工作方式上看

    `边缘部分`

    由所有连接到因特网上、供用户直接使用的主机组成（个人设备）

    `核心部分`

    由大量的网络和连接这些网络的路由器组成，为边缘部分提供连通性和交换服务

* 从功能组成上看

    `通信子网`

    由各种传输介质、通信设备和相应的网络协议组成（实现数据通信）

    `资源子网`

    是实现资源共享功能的设备及其软件的集合（实现资源共享/数据处理）

<img src="计算机网络.assets\image-20211024195702183.png" alt="image-20211024195702183" style="zoom:80%;" />

#### 计算机网络的分类

* 按分布范围

    `广域网（WAN）`

    ==使用交换技术==

    `城域网（MAN）`

    大多采用以太网技术

    `局域网（LAN）`

    ==采用广播技术==

    `个人区域网（PAN）`

* 按使用者

    `公用网`

    电信公司出资建造的大型网络

    `专用网`

    某个部门为满足本单位特殊业务的需要而建造的网络

* 按交换技术

    `电路交换网络`

    `报文交换网络`

    `分组交换网络`

* 按拓扑结构

![image-20211024200606697](计算机网络.assets\image-20211024200606697.png)

​		星形、总线形、环形网络多用于局域网

​		网状网络多用于广域网

* 按传输技术

    `广播式网络`

    __广域网中的无线、卫星通信网络也采用广播式通信技术__

    `点对点网络`

    __使用分组存储转发和路由选择机制__，广域网基本都属于点对点网络

#### 计算机网络的性能指标

`速率`

也称__数据传输速率、数据率、比特率__

单位b/s

通常把最高数据传输速率称为带宽

`带宽`

表示网络的通信线路传送数据的能力，通常是单位时间内从网络中的某一点到另一点所能通过的最高数据率

单位b/s

`吞吐量`

表示单位时间内通过某个网络的数据量

单位b/s

`时延`

==发送时延 = 数据长度 / 信道宽度（发送速率）==

==传播时延 = 信道长度 / 电磁波在信道上的传播速率==

==总时延 = 发送时延 + 传播时延 + 处理时延 + 排队时延==

`时延带宽积`

（某段链路上有多少比特，即容量）

==时延带宽积 = 传播时延 x 信道带宽==

`往返时延RTT`

表示从发送方发送数据开始，到发送方收到接收方的确认总共经历的时延

`信道利用率`

指某一信道有百分之多少的时间是有数据通过的

==信道利用率 = 有数据通过时间 / （有+无）数据通过时间==

#### 计算机网络体系结构与参考模型

##### 分层结构

`实体`

第n层的活动元素，指任何可发送或接收信息的硬件或软件进程

`对等层`

不同机器上的同一层

`对等实体`

同一层的实体

`协议`

为进行网络中的对等实体数据交换而建立的规则、标准或约定

__不对等实体间没有协议__

协议由语法、语义、同步三部分组成

* ==语法规定了传输数据的格式==
* ==语义规定了所要完成的功能，即需要发出何种控制信息、完成何种动作及做出何种应答==
* ==同步规定了执行各种操作的条件、时序关系==

`接口`

同一结点内==相邻两层间==交换信息的连接点

`服务`

指==下层为紧邻的上层提供的功能调用==

`服务数据单元（SDU）`

为完成用户所要求的功能而应传送的数据

`协议控制信息（PCI）`

控制协议操作的信息

`协议数据单元（PDU）`

对等层次之间传送的数据单元

PDU = PCI + SDU

##### 参考模型

`OSI参考模型`

![image-20211025142216381](计算机网络.assets\image-20211025142216381.png)

* 表示层

    ==数据格式变换、数据加密解密、数据压缩和恢复==

* 会话层

    ==建立、管理、终止会话==

    ==使用校验点可使会话在通信失效时从校验点/同步点继续恢复通信，实现数据同步==

* 传输层

    负责主机中两个进程之间的通信，即端到端的通信

    传输单位是报文段（TCP）和用户数据报（UDP）

    ==可靠传输、不可靠传输==，==差错控制==，==流量控制==，==复用分用==[^1]

* 网络层

    主要任务是把分组从源端传到目的端，为分组交换网上的不同主机提供通信服务

    传输单位：数据报/分组（二者父与子的关系）

    ==路由选择==，==流量控制==，==差错控制==，==拥塞控制==[^2]

* 数据链路层

    主要任务是把网络层传下来的数据报组装成帧

    传输单位：帧

    ==成帧==，==差错控制==，==流量控制==，==访问控制（控制对信道的访问）==

* 物理层

    主要任务是在物理媒体上实现比特流的透明传输

    传输单位：比特

    ==定义接口特性==，==定义传输模式==[^3]，==定义传输速率==，==比特同步==，==比特编码==

`TCP/IP参考模型`

<img src="计算机网络.assets\image-20211025145913489.png" alt="image-20211025145913489" style="zoom:80%;" />

<img src="计算机网络.assets\image-20211025145425457.png" alt="image-20211025145425457" style="zoom:80%;" />

<img src="计算机网络.assets\image-20211025150001272.png" alt="image-20211025150001272" style="zoom:67%;" />

### 第2章 物理层

`接口特性`

* 机械特性

    定义物理连接的特性，规定物理连接时所采用的==规格、接口形状、引线数目、引脚数量==

* 电气特性

    规定传输二进制位时，线路上信号的==电压范围、阻抗匹配、传输速率和距离限制==

* 功能特性

    指明某条线上出现的==某一电平表示何种意义==，接口部件的信号线的用途

* 规程特性

    也称过程特性，定义各条物理线路的==工作规程和时序关系==

#### 通信基础

`信源、信道与信宿`

__信源__：产生和发送数据的源头

__信宿__：接收数据的终点

__信道__：信号的传输媒介，==一条通信线路包含一条发送信道和一条接收信道==

​				按传输信号分为：模拟信道（传输模拟信号）、数字信道（传输数字信号）

​				按传输介质分为：无线信道、有线信道

`三种通信方式`

__单工通信__：只有一个方向的通信而没有反方向的交互，==需要一条信道==

__半双工通信__：通信的双方都可以发送或接收信息，但任何一方都不能同时发送和接收，==需要两条信道==

__全双工通信__：通信双方可以同时发送和接收信息，==需要两条信道==

`数据传输方式`

__串行传输__：速度慢、费用低、适合远距离

__并行传输__：速度快、费用高、适合近距离

`码元`

用一个固定时长的信号波形代表不同离散数值的基本波形，1码元可以携带多个比特的信息量

`速率`

也称数据率，指数据的传输速率，表示单位时间内传输的数据量，可用码元传输速率和信息传输速率表示

* __码元传输速率__

    也称__波特率__，表示单位时间内数字通信系统所传输的码元个数（也可称为脉冲个数或信号变化的次数）

    单位：__波特（Baud）__

    __码元速率与进制数无关，只与码元长度有关__

* __信息传输速率__

    又称__信息速率、比特率__，表示单位时间内数字通信系统传输二进制码元个数（即比特数）

    单位：比特/秒（b/s）

==若一个码元携带n比特的信息量，则M波特率的码元传输速率所对应的信息传输速率为Mn比特/秒==

![image-20211025214901504](计算机网络.assets\image-20211025214901504.png)

![image-20211025215119971](计算机网络.assets\image-20211025215119971.png)

`奈奎斯特定理与香农定理`

* __奈奎斯特定理__

    __在理想低通（没有噪声、带宽有限）的信道中，为了避免码间串扰，极限码元传输速率为2W波特__

    ==理想低通信道下的极限数据传输速率 = $2Wlog_2V$==（b/s）

    结论：①__在任何信道中，码元传输速率是有上限的__

    ​				②奈氏准则给出了码元传输速率的限制，但并未对信息传输速率给出限制

* __香农定理__

    ==信道的极限数据传输速率 = $Wlog_2(1+S/N)$==(b/s)

    ==信噪比（dB） = $10log_{10}(S/N)$==[^5]

    结论：①信道的带宽或信道的信噪比越大，则信息的极限传输速率就越高

    ​				②对一定的传输带宽和一定的信噪比，信息传输速率的上限就确定了

`编码与调制`

__编码__：数据 $\Rightarrow$ 数字信号

__调制__：数据 $\Rightarrow$ 模拟信号

<img src="计算机网络.assets\image-20211026140735745.png" alt="image-20211026140735745"  />

* __数字数据编码为数字信号__

    ![image-20211026203311471](计算机网络.assets\image-20211026203311471.png)

    ①__归零编码（RZ）__

    高电平代表1，低电平代表0，每个时钟周期的中间均跳变到低电平；

    ==提供了自同步机制==

    ②__非归零编码（NRZ）__
    
    同RZ编码，但不用归零
    
    ==无法同步==
    
    ③__反向非归零编码（NRZI）__
    
    用信号的翻转代表0，保持不变代表1
    
    ==能传输时钟信号，可同步==
    
    USB2.0通信编码就是NRZI编码
    
    ④__曼彻斯特编码__
    
    前一个间隔为高电平后一个间隔为低电平表示码元1；码元0相反
    
    ==既作为时钟信号（可用于同步），又作为数据信号==
    
    ==频带宽度使原始基带宽度的两倍（数据传输速率只有调制速率的1/2）==
    
    ==以太网使用的编码方式就是曼彻斯特编码==
    
    ⑤**差分曼彻斯特编码**
    
    ==常用于局域网传输==
    
    若码元为1，则前半个码元的电平与上一个码元的后半个码元的电平相同；若码元为0，则相反
    
    ==可实现自同步，抗干扰性较好==
    
    ⑥__4B/5B编码__
    
    比特流中插入额外的比特以打破一连串的0或1，就是用5个比特来编码4个比特的数据，再传给接收方
    
    ==编码效率为80%==
    
    





`数据交换方式`

* __电路交换__[^6]

    阶段：==建立连接 ——通信——释放连接==

    特点：__独占资源__，适用于远程批处理信息传输或系统间实时性要求高的大量数据传输的情况

    ![image-20211105170249437](计算机网络.assets\image-20211105170249437.png)

* __报文交换__

    数据交换单位：__报文__

    传输方式：==存储转发==

    ![image-20211105165339531](计算机网络.assets\image-20211105165339531.png)
    
* __分组交换__

    传输方式：==存储转发==（__限制所传输的数据单位的长度__）

    ![Snipaste_2021-11-05_17-00-20](计算机网络.assets\Snipaste_2021-11-05_17-00-20.png)

#### 物理层传输介质

`双绞线`

__绞合作用__：==绞合可以减少对相邻导线的电磁干扰==

__屏蔽双绞线（STP）__：为了进一步提高抗电磁干扰的能力，可在双绞线的外面再加上一层，即用金属丝编织成的屏蔽层；无屏蔽层的双绞线称为__非屏蔽双绞线（UTP）__

__特点__：==价格便宜==

`同轴电缆`

由于外导体屏蔽层的作用，==同轴电缆具有良好的抗干扰特性==

`光纤`

__多模光纤__：利用光的全反射特性，可以将从不同角度入射的多条光线在一根光纤中传输，这种光纤称为多模光纤，==多模光纤只适合于近距离传输==，==光源是发光二极管==

__单模光纤__：光纤的直径减小到只有一个光的波长时，光纤就像一根波导那样，可使光线一直向前传播，而不会产生多次反射；==单模光纤的光源为定向性很好的半导体激光器==，==适合远距离传输==

__特点__：①传输损耗小，中继距离长

​				②==抗雷电和电磁干扰性能好==

​				③不易被窃听或截取数据

​				④体积小，重量轻

`无线电波`

信号向所有方向传播

==具有较强的穿透能力==

`微波、红外线和激光`

信号固定方向传播，沿直线传播

__卫星通信__：利用地球同步卫星作为中继来转发微波信号；

​						 优点：==通信容量大、距离远、覆盖广、广播通信和多址通信==

​						 缺点：==保密性差、端到端传播时延长、受气候影响大、误码率高、成本高==

#### 物理层设备

`中继器`

__原理__：信号再生（而非简单地将衰减的信号放大）

==中继器两端的网络部分是网段，而不是子网==

==端口仅作用于信号的电器部分，而不管是否有错误或不适于网段的数据==

==使用中继器连接的几个网段仍然是一个局域网==

 ==中继器两端的网段一定要是同一个协议[^4]，且两个网段速率要相同==

==在采用粗同轴电缆的10BASE5以太网规范中，互相串联的中继器的个数不能超过4个，且用4个中继器串联的5段通信介质中只有3段可以挂接计算机==

|          |        中继器        |      放大器      |
| :------: | :------------------: | :--------------: |
| 信号种类 |       数字信号       |     模拟信号     |
|   原理   | 将衰减的信号整形再生 | 将衰减的信号放大 |

`集线器`

对信号进行再生放大转发，对衰减的信号进行放大，接着转发到其他所有（除输入端口外）处于工作状态的端口上，以增加信号传输的距离

__实质是一个多端口的中继器__

==集线器不能分割冲突域，所有集线器的端口都属于同一个冲突域==

==只能工作在半双工状态下==

### 第3章 数据链路层

#### 功能

①__为网络层提供服务__

无确认无连接服务、有确认无连接服务、有确认面向连接服务

②__链路管理__

连接的建立、维持、释放

③__组帧__

④__流量控制__

⑤__差错控制__

   #### 组帧

`字符计数法`

![image-20211107123704799](计算机网络.assets\image-20211107123704799.png)

如果计数字段出错，即失去了帧边界划分的依据，那么接收方就无法判断所传输帧的结束位和下一帧的开始位，收发双方将失去同步

`字符填充的首尾定界符法`

![image-20211107114412987](计算机网络.assets\image-20211107114412987.png)

发送方在每个EOT或SOH字符前再插入一个ESC字符，接收方收到数据后再删除这个插入的ESC字符

`零比特填充的首尾标志法`

用01111110标志一帧的开始和结束

为了不使信息位中出现的比特流01111110被误判为帧的首尾标志，发送方的数据链路层在信息位中遇到5个连续的1时，将自动在其后插入一个0，而接收方每收到5个连续的1时，自动删除后面的0

==容易由硬件实现，性能优于字符填充法==

`违规编码法`

在物理层进行比特编码时，通常采用违规编码法。曼彻斯特编码将数据比特1编码成“高-低”电平对，将数据比特0编码成“低-高”电平对，而“高-高”电平对和“低-低”电平对在数据比特中是违规的，可以借用这些违规编码序列来定界帧的起始和终止

==目前较普遍使用的帧同步法是比特填充和违规编码法==

#### 流量控制

 `停止-等待协议`

__出错情况:__

①**数据帧丢失或到达目的站的帧遭到破坏**

​	（接收方会将损坏的帧丢弃）在一个帧发送后，发送方等待确认，如果在计时器计满时仍未收到确认，则再次发送相同的帧

​	![image-20211108134958699](计算机网络.assets\image-20211108134958699.png)

②**确认帧丢失或遭到破坏**

​	发送方会重传已被接收的数据帧，接收方收到同样的数据帧会丢弃该帧，并重传一个该帧对应的确认帧

​	![image-20211108134927554](计算机网络.assets\image-20211108134927554.png)

③__确认帧迟到__

​	![image-20211108135116259](计算机网络.assets\image-20211108135116259.png)

==停止-等待协议通信信道的利用率低==

`后退N帧协议(GBN)`

==接收方只允许按顺序接收帧==，虽然又收到了其他帧，但必须将这些帧==丢弃==，且==应重复发送已发送的最后一个确认帧==

==可以在连续收到好几个正确的数据帧后，才对最后一个数据帧发确认信息==

__发送窗口尺寸__：==$1\leqslant W_T \leqslant 2^n-1 $==

![image-20211108134413506](计算机网络.assets\image-20211108134413506.png)

![image-20211108141845635](计算机网络.assets\image-20211108141845635.png)

`选择重传协议(SR)`

![image-20211108133913558](计算机网络.assets\image-20211108133913558.png)

__发送方__：①如果收到ACK且帧序号在窗口内，则将该帧标记为已接收；如果该帧是窗口的下界，则将窗口向前移动到具有最小序号的未确认帧处；如果窗口移动了且窗口内有未发送的帧，则发送这些帧

​					 ②每个帧都有自己的定时器，一个超时事件发生后只重传一个帧

__接收方__：将确认一个正确接受的帧而不管其是否按序，失序的帧将被缓存，并返回给发送方一个该帧的确认帧，直到所有帧被收到为止，才将这批帧交付上层，向前移动滑动窗口

![image-20211108140030699](计算机网络.assets\image-20211108140030699.png)

==$W_{Tmax}=W_{Rmax}=2^{(n-1)}$==







`其他`

__停止-等待协议__：==发送窗口大小=1，接收窗口大小=1==

__后退N帧协议__：==发送窗口大小>1，接收窗口大小=1==

__选择重传协议__：==发送窗口大小>1，接收窗口大小>1==

__信道利用率__：==$信道利用率=(L/C)/T=帧的传输时延/(帧的传输时延+确认帧的传输时延+2\times传播时延)$==[^7]

__信道吞吐率__：==信道吞吐率=信道利用率*发送方的发送速率==































[^1]: 复用：多个应用层进程可同时使用下面运输层的服务；分用：运输层把收到的信息分别交付给上面应用层中相应的进程
[^2]: 若所有结点都来不及接受分组，而要丢弃大量分组的话，网络就处于拥塞状态。因此要采取一定措施缓解这种拥塞
[^3]: 单工、半双工、双工

[^4]: 如果某个网络设备具有存储转发的功能，那么可以认为它能连接两个不同的协议，即==中继器没有存储转发的功能==

[^5]: W:信道的带宽；S:信道所传输信号的平均功率；N:信道内部的高斯噪声功率
[^6]: 在进行数据传输前，两个结点之间必须先建立一条专用（双方独占）的物理通信路径（由通信双方之间的交换设备和链路逐段连接而成），该路径可能经过许多中间结点，在数据传输结束之前，这条线路一直保持

[^7]: T:发送周期，L：T内发送L比特数据，C：发送方的数据传输速率
