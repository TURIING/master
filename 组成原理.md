### 第一章 计算机系统概述

#### 计算机的分类与发展方向

`按指令和数据流分类`

* **单指令流和单数据流系统**

	==冯·诺伊曼体系结构==

* **单指令流和多数据系统**

	阵列处理器和向量处理器系统

* **多指令流和单数据流系统**

	不存在

* **多指令流和多数据流系统**

	多处理器和多计算机系统

#### 计算机系统层次结构

##### 计算机系统的组成

==硬件系统和软件系统==共同构成流一个完整的计算机系统

某功能既可以用软件实现也可以用硬件实现，则称==软件硬件在逻辑上是等效的（等价❌）==

##### 早期的冯·诺伊曼机

冯·诺伊曼在研究EDVAC机时提出了“==存储程序==”的概念

> 存储程序： 指将指令以代码的形式事先输入计算机的主存储器，然后按其在存储器中的首地址执行程序的第一条指令，以后就按该程序的规定顺序执行其他指令，直到程序执行结束

**特点**：

​		1⃣️ 计算机硬件系统由==运算器、存储器、控制器、输入设备、输出设备==组成

​		2⃣️ 指令和数据以==同等地位==存储在存储器中，并可按地址寻访

​		3⃣️ ==指令和数据均用二进制代码表示==

​		4⃣️ 指令由操作码和地址码组成

​		5⃣️ 指令在存储器内按顺序存放

​		6⃣️  ==以运算器为中心==，**输入、输出设备通过运算器与存储器传送数据**

##### 现代计算机结构

==存储器为中心==、==CPU = 运算器+控制器==

##### 计算机的功能部件

`主存储器`

**组成**：==MAR、MDR、地址译码器==

**工作方式**：==按地址存取方式==（按存储单元的地址进行存取）

**地址寄存器（MAR）**：==存放访存地址==，经过地址译码后找到所选的存储单元，==MAR位数=存储单元的个数==

**数据寄存器（MDR）**：==用于暂存要从存储器中读或写的信息==，==MDR位数=存储字长==

==现代计算机通常把MAR、MDR集成在CPU中（控制器内）==

|   概念   |                             描述                             |
| :------: | :----------------------------------------------------------: |
|  存储元  |           存储二进制的电子元件，每个存储元可存1bit           |
| 存储单元 |                每个存储单元存放一串二进制代码                |
|  存储字  |                  存储单元中存储的二进制代码                  |
|    字    | 计算机在进行数据处理，一次存取、加工、传送的数据长度，一个字由多个字节组成；**随架构改变字长**（如64位CPU中一字为64位） |
|   字长   |                    计算机每个字包含的位数                    |

`运算器`

**功能**：用于算术运算（加减乘除）和逻辑运算（与或非）

**组成**：

* **算术逻辑单元（ALU）**

	通过内部复杂的电路实现算术运算、逻辑运算

* **累加器（ACC）**

	用于存放操作数或运算结果

* **乘商寄存器（MQ）**

	在乘除运算时，用于存放操作数或运算结果

* **操作数寄存器（X）**

	用于存放操作数

* **程序状态寄存器（PSW、标志寄存器）**

	用于存放ALU运算得到的一些标志信息或处理机的状态信息（如结果是否溢出、有无进位或错位、结果是否为负）

* **变址寄存器（IX）**

* **基址寄存器（BR）**

==寄存器的基本单元是D触发器==

`控制器`

* **控制单元（CU）**

	分析指令，给出控制信号

* **程序计数器（PC）**

	用于==存放下一条指令的地址==，有自动加1功能

* **指令寄存器（IR）**

	==存放当前执行的指令==

|  是否可见  |            器件            |
| :--------: | :------------------------: |
|  用户可见  | 通用寄存器、程序状态寄存器 |
| 用户不可见 |    MAR、MDR、指令寄存器    |

##### 计算机软件的分类

* **系统软件**

	==操作系统、数据库管理系统（DBMS）、语言处理程序（编译器）、分布式软件系统、网络软件系统、标准库程序、服务性程序（链接器）==

	> DBMS： 位于用户和操作系统之间的一层数据管理软件，是系统软件
	>
	> DBS： 指计算机系统中引入数据库后的系统，一般由数据库、数据库管理系统、数据库管理员（DBA）和应用系统构成

* **应用软件**

##### 计算机系统的多级层次结构

<img src="组成原理.assets/截屏2022-04-19 00.31.31.png" alt="截屏2022-04-19 00.31.31" style="zoom: 67%;" />

==下层是上层的基础，上层是下层的扩展==、==上下层是可以分割的，仅有下层而没有上层也是可以的==、==上层是下层的功能实现==

#### 计算机的性能指标

`机器字长`

**定义**：指计算机进行一个整数运算所能处理的二进制数据的位数，衡量计算机并行处理的能力

==机器字长等于CPU内部用于整数运算的运算器位数和通用寄存器位数（浮点寄存器位数❌）==

|   概念   |               描述               |
| :------: | :------------------------------: |
| 指令字长 | 一个指令中包含的二进制代码的位数 |
| 存储字长 | 一个存储单元存储二进制数据的位数 |
| 数据字长 | 数据总线一次能并行传送信息的位数 |

`数据通路带宽`

**定义**：==指数据总线一次所能并行传送信息的位数==，衡量计算机在功能级部件间传送数据的能力

**数据通路**：数据在功能部件之间传送的路径（如内存到CPU）

`吞吐量`

**定义**：==指系统在单位时间内处理请求的数量==

`响应时间`

**定义**：**指用户向计算机发送一个请求，到系统对该请求作出响应并获得所需结果的等待时间**

`主频和CPU时钟周期`

**CPU时钟周期**：CPU中==最小的时间单位==(us、ns)，执行指令的每个动作至少需要1个时钟周期，==CPU时钟周期 = 1 / 主频==

**主频（CPU时钟频率）**：主频越高，执行指令的速度越快（Hz）

|   概念   |                     描述                      |
| :------: | :-------------------------------------------: |
| 指令周期 | CPU从内存取出一条指令并执行这条指令的时间总和 |
| CPU周期  |   又称机器周期，从内存取一条指令的最短时间    |
| 中断周期 |           执行一次中断所需要的周期            |

`CPI`

**定义**：==执行一条指令所需的时钟周期数==

对于一个程序或一台机器来说，CPI指该程序或该机器指令集中的所有指令执行所需的**平均时钟周期数**

==执行一条指令的耗时 = CPI x CPU时钟周期==

==时钟频率并不会影响CPI，但可加快指令的执行速度==

> **主频高的CPU不一定比主频低的CPU快**
>
> 如A的主频2GHz，CPI=10；B的主频1GHz，CPI=1
>
> **若CPI相同，主频高的CPU也不一定比主频低的CPU快**
>
> 还要看指令系统，如A不支持乘法指令，只能用多次加法实现乘法，而B支持乘法

`CPU执行时间`

**定义**：**运行一个程序所花费的时间**

==CPU执行时间 = CPU时钟周期数/主频 = (指令条数xCPI)/主频 = CPI x 指令条数 x 时钟周期==

`IPS`

**定义**：==每秒执行多少条指令==，==IPS = 主频/CPI==

**MIPS**:==每秒执行多少百万条指令==，==MIPS = 指令条数/(执行时间x10^6) = 主频/(CPIx10^6)==

`FLOPS`

**定义**：==每秒执行多少次浮点运算==

==MFLOPS = 浮点操作次数/(执行时间x10^6)==

**$$K(10^3)、M（10^6）、G(10^9)、T(10^{12})$$**

`专业术语`

>**基准程序**
>
><u>用来进行性能评价的一组程序</u>
>
>**系列机**： 具有基本相同的体系结构，使用相同基本指令系统的多个不同型号的计算机组成的一个产品系列
>
>**兼容**：指计算机软件或硬件的通用性，即使用或运行在某个型号的计算机系统中的硬件/软件也能应用于另一个型号的计算机系统
>
>**单片机**：<u>CPU+存储器+中断、IO = 单片机</u>

### 第二章 数据的表示和运算

#### 数制与编码

##### 进制的相互转换

`二进制 -> 八进制、十六进制`



`任意进制 -> 十进制`

`十进制 -> 任意进制`

##### 真值和机器数

| 概念 | 描述 |
| :--: | :--: |
|      |      |

#### 定点数的表示与运算

##### 定点数的表示

`无符号数`

(全部二进制位均为数值位)

**范围**:==$$0～2^n-1$$==

==通常只有无符号整数，没有无符号小数==

`补码`

定点整数：==$$[x]_补 = 1,00..00\Rightarrow x=-2^n$$==

定点小数：==$$[x]_补 = 1.00..00 \Rightarrow x=-1$$==

==$$[x]_补 \to [-x]_补$$：符号位、数值位全部取反，末位加1==

`移码`

**常用于表示浮点数的阶码** ==只能表示整数==

==补码的符号位取反即移码==

`与原码的相互转换`

|      |   正数   |                     负数                      |
| :--: | :------: | :-------------------------------------------: |
| 反码 | ==相同== | ==若符号位为1，则符号位不变，数值位全部取反== |
| 补码 | ==相同== |    ==符号位不变，数值位按位取反，末位加1==    |

（字长为n+1）

|      |           整数范围            |               小数范围                |                      真值0                      |
| :--: | :---------------------------: | :-----------------------------------: | :---------------------------------------------: |
| 原码 | ==$$-(2^n-1)\le x\le2^n-1$$== | ==$$-(1-2^{-n})\le x \le 1-2^{-n}$$== | ==不唯一，$$[+0]_原 = 00000,[-0]_原 = 10000$$== |
| 反码 |            同原码             |                同原码                 |  ==不唯一$$[+0]_反 = 00000,[-0]_反 = 11111$$==  |
| 补码 |  ==$$-2^n\le x \le 2^n-1$$==  |     ==$$-1\le x \le 1-2^{-n}$$==      |      ==唯一，$$[+0]_补 =[-0]_补 00000$$==       |
| 移码 |            同补码             |                  无                   |     ==唯一，$$[+0]_移 = [-0]_移 = 10000$$==     |

### 第三章 存储系统

#### 存储器概述

##### 存储器的层次化结构

**主存--辅存**：==解决了主存容量不够的问题==

**Cache--主存**：==解决了主存和CPU速度不匹配的问题==

主存和Cache之间的数据调动是由==硬件==自动完成的，对==所有程序员是透明的==

主存和辅存之间的数据调动是由==硬件和操作系统==共同完成的，对==应用程序员是透明的==

##### 存储器的分类

`按存储介质分类`

磁表面存储器（磁盘、磁带）、半导体存储器（主存、Cache）、光存储器（光盘）

`按存取方式分类`

* **随机存储器（RAM）**

	存取时间与存储单元的物理位置无关

* **只读存储器（ROM）**

	存储器的内容只能随机读出而不能写入

	==ROM和RAM均为随机存取==

* **串行访问存储器**

	（读写某个存储单元所需时间与存储单元的物理位置有关）

	* **顺序存取存储器（SAM）**

		读写一个存储单元所需时间取决于存储单元所在的物理位置（磁带）

		==存取速度慢==

	* **直接存取存储器（DAM）**

		先直接选取信息所在区域，然后按顺序方式存取（磁盘、光盘）

		==既有随机存取特性，也有顺序存取特性==

* **相联存储器**

	可以按==内容或地址==检索到存储位置进行读写（快表）

`按信息的可保存性`

* **易失性存储器**

	断电后，存储信息即消失（RAM）

* **非易失性存储器**

	断电后，存储信息依然保持（ROM）

* **破坏性读出**

	信息读出后，原存储信息被破坏

* **非破坏性读出**

	信息读出后，原存储信息不被破坏

##### 存储器的性能指标

`存储容量`

==存储容量 = 存储字数 X 字长==（如8Kx8位，即$2^{13}\times 8bit$）

`单位成本`

==每位价格 = 总成本 / 总容量==

`存储速度`

==数据传输率（主存带宽） = 数据的宽度（存储字长）/ 存储周期==

**存取时间**：指从启动一次存储器操作到完成该操作所经历的时间

**存取周期**：连续两次独立访问存储器操作之间所需的最小时间间隔

<img src="组成原理.assets/截屏2022-06-28 21.16.34.png" alt="截屏2022-06-28 21.16.34" style="zoom: 80%;" />

#### 半导体随机存储器

##### SRAM和DRAM

**SRAM、DRAM都属于易失性存储器**

 `DRAM`

==用于主存==（**现在的主存通常采用SDRAM**）

存储元使用==栅极电容==存储信息，==破坏性读出==，读出后需要重写信息；

==分两次送行列地址==（地址线复用技术，导致地址线、地址引脚减半）

**优点**：==容易集成、成本低、集成度高、功耗低==

**缺点**：==存取速度比SRAM慢==

**刷新**：（**刷新周期为2ms，每次刷新一行存储单元**（<u>采用行列地址为了减少选通线的数量</u>））

<u>“刷新”由存储器独立完成，不需要CPU控制</u>

* **集中刷新**

	在一个刷新周期内，利用一段固定的时间，依次对存储器的所有行进行逐一再生，在此期间停止对存储器的读写操作（称为<u>死时间、访存死区</u>）

* **分散刷新**

	把对每行的刷新分散到各个工作周期中，一个存储器的系统工作周期分为两部分，前半部分用于正常读、写，后半部分用于刷新

* **异步刷新**

	将刷新周期除以行数，得到两次刷新操作之间的时间间隔t，利用逻辑电路每隔时间t产生一次刷新请求

	**既可缩短“死时间”，又能充分利用最大刷新间隔为2ms的特点**

`SRAM`

==用于Cache==

存储元使用==双稳态触发器==存储信息，==非破坏性读出==，==同时送行列地址==

**优点**：==存取速度快==

**缺点**：==成本高、集成度低、功耗大==

##### 只读存储器

`掩模式只读存储器（MROM）`

厂家在生产过程直接写入，==写入以后任何人无法改变内容==

**优点**：==可靠性高，集成度高，价格便宜==

**缺点**：==灵活性差==

`一次可编程只读存储器（PROM）`

允许用户利用专门的设备写入自己的程序，==一旦写入，内容无法改变==

`可擦除可编程只读存储器（EPROM）`

允许用户写入信息，且==可多次重写==

* **紫外线擦除（UVEPROM）**

	需要擦除全部，然后写入

* **电擦除（EEPROM）**

	只需擦除特定的字

`闪速存储器（Flash Memory）`

（U盘、SD卡）

<u>存储元由mos管组成</u>

==断电后也能保存信息，且可进行多次快速擦除重写==（读比写快，因为写入需要先擦除原有数据）

`固态硬盘`

<u>由控制单元和存储单元（Flash芯片）构成</u>

==速度快、功耗低，但价格高==
